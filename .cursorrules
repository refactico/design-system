# Component Creation Rules for Cursor AI

## üéØ Design System Philosophy

**CRITICAL:** This is a design system abstraction layer. Our users should ONLY use `r-*` components, NEVER `ion-*` components directly.

**Why?** 
- Complete abstraction from Ionic - if we switch frameworks in the future, users' code won't break
- Users only need to learn our `r-*` API, not Ionic's API
- Consistent design system experience across all components
- Future-proof architecture

**Rule:** If an Ionic component has sub-components that users would need, we MUST wrap ALL of them.

**Example:** 
- `ion-card` has `ion-card-header`, `ion-card-title`, `ion-card-content`, `ion-card-subtitle`, `ion-card-footer`
- We need: `r-card`, `r-card-header`, `r-card-title`, `r-card-content`, `r-card-subtitle`, `r-card-footer`
- Users should NEVER use `ion-card-header` - they use `r-card-header` instead

**IMPORTANT:** When asked to create a new component (e.g., "create r-card component"), you MUST:
1. Read this file first
2. Check `COMPONENT_TEMPLATE.tsx` for the template
3. Read `COMPONENT_CREATION_GUIDE.md` for detailed patterns
4. Look at existing components (`r-badge`, `r-input`, etc.) for examples
5. **Check if the Ionic component has sub-components that need wrapping**
6. Follow ALL rules below

When creating new components in this design system, you MUST follow these rules:

## Required Imports

1. **Always import utilities:**
   ```typescript
   import { removeUndefinedProps, IonicColor, FillStyle, IonicMode } from '../../utils';
   ```

2. **For form field components, also import:**
   ```typescript
   import { buildFormFieldProps, getLabelPosition, getItemLines } from '../../utils/form-field-props';
   ```

## Workflow When Creating Components

1. **FIRST:** Read `COMPONENT_TEMPLATE.tsx` - Copy it as your starting point
2. **SECOND:** Check `COMPONENT_CREATION_GUIDE.md` for patterns and examples
3. **THIRD:** **CRITICAL - Check for sub-components:**
   - Research the Ionic component documentation
   - Identify ALL sub-components (e.g., `ion-card-header`, `ion-card-title`, etc.)
   - **You MUST create wrappers for ALL sub-components that users would need**
   - Example: For `ion-card`, create `r-card`, `r-card-header`, `r-card-title`, `r-card-content`, `r-card-subtitle`, `r-card-footer`
4. **FOURTH:** Look at existing components:
   - Simple component? ‚Üí See `src/components/r-badge/` or `src/components/r-buttons/`
   - Form field component? ‚Üí See `src/components/r-input/`, `src/components/r-dropdown/`, or `src/components/r-datepicker/`
   - Component with sub-components? ‚Üí See `r-header` + `r-toolbar` + `r-title` pattern
5. **FIFTH:** Create all required files for main component AND all sub-components (see File Structure below)
6. **SIXTH:** Add component to `src/components/app-home/app-home.tsx` menu and examples

## Required Patterns

1. **ALWAYS use `removeUndefinedProps`** - Never manually filter props with `Object.keys().forEach()`
   ```typescript
   // ‚ùå WRONG
   const props: any = { color: this.color };
   Object.keys(props).forEach(key => { if (props[key] === undefined) delete props[key]; });
   
   // ‚úÖ CORRECT
   const props = removeUndefinedProps({ color: this.color, size: this.size });
   ```

2. **ALWAYS use type definitions:**
   - `IonicColor` instead of `string` for color props
   - `FillStyle` instead of `'outline' | 'solid'` for fill props
   - `IonicMode` instead of `'ios' | 'md'` for mode props
   ```typescript
   // ‚ùå WRONG
   @Prop() color?: string;
   @Prop() fill?: 'outline' | 'solid';
   
   // ‚úÖ CORRECT
   import { IonicColor, FillStyle } from '../../utils';
   @Prop() color?: IonicColor;
   @Prop() fill?: FillStyle;
   ```

3. **For form field components (has label, error, helper text):**
   - Use `buildFormFieldProps()` for common props
   - Use `getLabelPosition()` for label positioning
   - Use `getItemLines()` for item lines styling
   - See `src/components/r-dropdown/r-dropdown.tsx` for complete example

4. **Component decorator:**
   ```typescript
   @Component({
     tag: 'r-component-name',
     styleUrl: 'r-component-name.css',
     shadow: false, // Always false for Ionic components
   })
   ```

## File Structure

Every component must have:
- `r-component-name.tsx` - Component implementation
- `r-component-name.css` - Component styles
- `r-component-name.spec.ts` - Unit tests
- `r-component-name.e2e.ts` - E2E tests
- `r-component-name.stories.ts` - Storybook stories
- `readme.md` - Documentation (auto-generated)

## Integration (REQUIRED)

After creating a component, you MUST:
1. Add to `src/components/app-home/app-home.tsx`:
   - Add entry to `menuItems` array
   - Add rendering block with examples in the `render()` method
2. Verify component works:
   - Run `npm run build` (should succeed)
   - Component should appear in app-home menu
   - Examples should render correctly

## Reference Files

- `COMPONENT_CREATION_GUIDE.md` - Full guide
- `COMPONENT_TEMPLATE.tsx` - Template file
- `COMPONENT_CHECKLIST.md` - Verification checklist
- `COMPONENT_QUICK_REFERENCE.md` - Quick reference

## Examples

- Simple component: See `r-badge` or `r-buttons`
- Form field component: See `r-input`, `r-dropdown`, or `r-datepicker`

## DO NOT

- ‚ùå Use `string` type for colors - use `IonicColor`
- ‚ùå Manually filter props - use `removeUndefinedProps`
- ‚ùå Duplicate form field code - use form field utilities
- ‚ùå Set `shadow: true` - always use `shadow: false`
- ‚ùå **Leave Ionic sub-components unwrapped** - If users need them, wrap them!
- ‚ùå **Document or show `ion-*` components in examples** - Always use `r-*` components
- ‚ùå **Assume users can use Ionic directly** - They should ONLY use our `r-*` components

## Sub-Component Strategy

**When to create sub-component wrappers:**

‚úÖ **DO create wrappers if:**
- The Ionic component has sub-components (e.g., `ion-card` ‚Üí `ion-card-header`, `ion-card-title`)
- Users would need these sub-components to build complete UIs
- The sub-components are part of the component's API (not just internal implementation)

‚ùå **DON'T create wrappers if:**
- The sub-components are purely internal implementation details
- Users never interact with them directly
- They're only used internally by the main component

**Examples:**
- ‚úÖ `ion-card` ‚Üí Need: `r-card`, `r-card-header`, `r-card-title`, `r-card-content`, `r-card-subtitle`, `r-card-footer`
- ‚úÖ `ion-item` ‚Üí Need: `r-item` (if we create it), `r-item-sliding`, `r-item-options`
- ‚ùå `ion-input` ‚Üí No sub-components needed (we already have `r-input`)
- ‚ùå `ion-button` ‚Üí No sub-components needed (we already have `r-button`)

