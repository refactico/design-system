# Component Creation Rules for Cursor AI

## üéØ Design System Philosophy

**CRITICAL:** This is a design system abstraction layer. Our users should ONLY use `r-*` components, NEVER `ion-*` components directly.

**Why?** 
- Complete abstraction from Ionic - if we switch frameworks in the future, users' code won't break
- Users only need to learn our `r-*` API, not Ionic's API
- Consistent design system experience across all components
- Future-proof architecture

**Rule:** If an Ionic component has sub-components that users would need, we MUST wrap ALL of them.

**Example:** 
- `ion-card` has `ion-card-header`, `ion-card-title`, `ion-card-content`, `ion-card-subtitle`, `ion-card-footer`
- We need: `r-card`, `r-card-header`, `r-card-title`, `r-card-content`, `r-card-subtitle`, `r-card-footer`
- Users should NEVER use `ion-card-header` - they use `r-card-header` instead

**IMPORTANT:** When asked to create a new component (e.g., "create r-card component"), you MUST:
1. **Read this file first** - `.cursorrules`
2. **Read `architecture/PRODUCTION_READINESS_GUIDE.md`** - **CRITICAL: Production requirements**
3. **Read `component-creation/COMPONENT_CREATION_GUIDE.md`** - Detailed patterns and examples
4. **Read `component-creation/COMPONENT_CHECKLIST.md`** - Verification checklist
5. **Read `component-creation/SUB_COMPONENT_STRATEGY.md`** - Sub-component strategy
6. **Check `component-creation/COMPONENT_TEMPLATE.tsx`** - Component template
7. **Look at existing components** (`r-badge`, `r-input`, etc.) for examples
8. **Check if the Ionic component has sub-components that need wrapping**
9. **Update `component-creation/COMPONENT_CREATION_VERIFICATION.md`** - Add verification log entry
10. Follow ALL rules below

**VERIFICATION:** After reading all files, you MUST update `component-creation/COMPONENT_CREATION_VERIFICATION.md` with a log entry showing you've read and verified all requirements.

When creating new components in this design system, you MUST follow these rules:

## Required Imports

1. **Always import utilities:**
   ```typescript
   import { removeUndefinedProps, IonicColor, FillStyle, IonicMode } from '../../utils';
   ```

2. **For form field components, also import:**
   ```typescript
   import { buildFormFieldProps, getLabelPosition, getItemLines } from '../../utils/form-field-props';
   ```

## Workflow When Creating Components

**STEP 0: VERIFICATION - Read All Guidelines First**
- [ ] Read `.cursorrules` (this file)
- [ ] Read `architecture/PRODUCTION_READINESS_GUIDE.md` - **CRITICAL**
- [ ] Read `component-creation/COMPONENT_CREATION_GUIDE.md`
- [ ] Read `component-creation/COMPONENT_CHECKLIST.md`
- [ ] Read `component-creation/SUB_COMPONENT_STRATEGY.md`
- [ ] Check `component-creation/COMPONENT_TEMPLATE.tsx`
- [ ] Look at existing similar components
- [ ] **Update `component-creation/COMPONENT_CREATION_VERIFICATION.md`** - Add log entry

1. **FIRST:** Read `component-creation/COMPONENT_TEMPLATE.tsx` - Copy it as your starting point
2. **SECOND:** Check `component-creation/COMPONENT_CREATION_GUIDE.md` for patterns and examples
3. **THIRD:** **CRITICAL - Production Readiness & Use Cases Analysis:**
   - **Research ALL use cases** - Think about how 69+ apps and big clients will use this component
   - **Identify ALL props/features** - Review Ionic documentation thoroughly, don't miss any useful props
   - **Consider ALL edge cases** - Disabled states, error states, loading states, empty states, validation, etc.
   - **Think about real-world scenarios** - What will users actually need? Don't create minimal components
   - **Goal: Production-ready from day one** - Users shouldn't come back asking for missing features or reporting bugs
4. **FOURTH:** **CRITICAL - Check for sub-components:**
   - Research the Ionic component documentation
   - Identify ALL sub-components (e.g., `ion-card-header`, `ion-card-title`, etc.)
   - **You MUST create wrappers for ALL sub-components that users would need**
   - Example: For `ion-card`, create `r-card`, `r-card-header`, `r-card-title`, `r-card-content`, `r-card-subtitle`, `r-card-footer`
5. **FIFTH:** Look at existing components:
   - Simple component? ‚Üí See `src/components/r-badge/` or `src/components/r-buttons/`
   - Form field component? ‚Üí See `src/components/r-input/`, `src/components/r-dropdown/`, or `src/components/r-datepicker/`
   - Component with sub-components? ‚Üí See `r-header` + `r-toolbar` + `r-title` pattern
6. **SIXTH:** Create all required files for main component AND all sub-components (see File Structure below)
7. **SEVENTH:** Add component to `src/components/app-home/app-home.tsx` menu and examples
8. **EIGHTH:** **CRITICAL - Comprehensive Testing:**
   - Test ALL props combinations
   - Test ALL edge cases (disabled, error, empty, loading states)
   - Test in different scenarios (mobile, desktop, different screen sizes)
   - Verify no console errors or warnings
   - Test accessibility
9. **NINTH:** **VERIFICATION - Update Verification Log:**
   - Update `component-creation/COMPONENT_CREATION_VERIFICATION.md` with log entry
   - Verify all checklist items completed
   - Confirm production-ready status

## Batch Component Creation

**When creating multiple components in one prompt:**

1. **Read `component-creation/BATCH_COMPONENT_CREATION.md`** - Batch creation guide
2. **Recommended batch size:** 2-5 components (not more than 5)
3. **Group by similarity:** Related components or similar complexity
4. **Apply ALL rules to EACH component** - Don't skip steps for any component
5. **Verify EACH component individually** - Test each one separately
6. **Update verification log for ALL components** - One entry per component

**Example batch request:**
```
Create these 3 components in batch:
1. r-badge - Simple badge component
2. r-chip - Chip component
3. r-label - Label component

All should follow component creation guidelines.
```

**For each component in the batch, you MUST:**
- Follow all workflow steps (1-9 above)
- Research each component individually
- Create all required files for each
- Test each component separately
- Update verification log for each

**‚ö†Ô∏è Don't batch more than 5 components** - Quality verification becomes difficult.

## Required Patterns

1. **ALWAYS use `removeUndefinedProps`** - Never manually filter props with `Object.keys().forEach()`
   ```typescript
   // ‚ùå WRONG
   const props: any = { color: this.color };
   Object.keys(props).forEach(key => { if (props[key] === undefined) delete props[key]; });
   
   // ‚úÖ CORRECT
   const props = removeUndefinedProps({ color: this.color, size: this.size });
   ```

2. **ALWAYS use type definitions:**
   - `IonicColor` instead of `string` for color props
   - `FillStyle` instead of `'outline' | 'solid'` for fill props
   - `IonicMode` instead of `'ios' | 'md'` for mode props
   ```typescript
   // ‚ùå WRONG
   @Prop() color?: string;
   @Prop() fill?: 'outline' | 'solid';
   
   // ‚úÖ CORRECT
   import { IonicColor, FillStyle } from '../../utils';
   @Prop() color?: IonicColor;
   @Prop() fill?: FillStyle;
   ```

3. **For form field components (has label, error, helper text):**
   - Use `buildFormFieldProps()` for common props
   - Use `getLabelPosition()` for label positioning
   - Use `getItemLines()` for item lines styling
   - See `src/components/r-dropdown/r-dropdown.tsx` for complete example

4. **Component decorator:**
   ```typescript
   @Component({
     tag: 'r-component-name',
     styleUrl: 'r-component-name.css',
     shadow: false, // Always false for Ionic components
   })
   ```

## File Structure

Every component must have:
- `r-component-name.tsx` - Component implementation
- `r-component-name.css` - Component styles
- `r-component-name.spec.ts` - Unit tests
- `r-component-name.e2e.ts` - E2E tests
- `r-component-name.stories.ts` - Storybook stories
- `readme.md` - Documentation (auto-generated)

## Integration (REQUIRED)

After creating a component, you MUST:
1. Add to `src/components/app-home/app-home.tsx`:
   - Add entry to `menuItems` array
   - Add rendering block with examples in the `render()` method
2. Verify component works:
   - Run `npm run build` (should succeed)
   - Component should appear in app-home menu
   - Examples should render correctly

## Reference Files (READ ALL BEFORE CREATING COMPONENTS)

**MANDATORY READING ORDER:**
1. `.cursorrules` (this file) - **START HERE**
2. `architecture/PRODUCTION_READINESS_GUIDE.md` - **CRITICAL: Production requirements**
3. `component-creation/COMPONENT_CREATION_GUIDE.md` - Full guide with patterns
4. `component-creation/COMPONENT_CHECKLIST.md` - Verification checklist
5. `component-creation/SUB_COMPONENT_STRATEGY.md` - Sub-component strategy
6. `component-creation/COMPONENT_TEMPLATE.tsx` - Template file
7. `component-creation/COMPONENT_QUICK_REFERENCE.md` - Quick reference
8. `component-creation/COMPONENT_CREATION_VERIFICATION.md` - **VERIFICATION LOG (update this!)**

**VERIFICATION:** After reading, update `component-creation/COMPONENT_CREATION_VERIFICATION.md` to prove you've read all files.
- `architecture/PRODUCTION_READINESS_GUIDE.md` - **CRITICAL: Read this for production-ready requirements**
- `component-creation/SUB_COMPONENT_STRATEGY.md` - Strategy for sub-components

## Examples

- Simple component: See `r-badge` or `r-buttons`
- Form field component: See `r-input`, `r-dropdown`, or `r-datepicker`

## üö® Production Readiness Requirements

**CRITICAL:** This design system is used by 69+ apps and big enterprise clients. Components MUST be production-ready from day one.

**You MUST:**
- ‚úÖ **Include ALL useful props** - Don't create minimal components, include all props users might need
- ‚úÖ **Handle ALL edge cases** - Disabled, error, loading, empty states, etc.
- ‚úÖ **Test thoroughly** - Test all combinations, all scenarios, all edge cases
- ‚úÖ **Think about real-world usage** - How will 69+ apps use this? What features do they need?
- ‚úÖ **No bugs on release** - Components should work perfectly, users shouldn't report issues
- ‚úÖ **Complete feature set** - Don't leave out features that users will need later
- ‚úÖ **Comprehensive examples** - Show all use cases in app-home and Storybook

**You MUST NOT:**
- ‚ùå Create minimal components - Include all useful features upfront
- ‚ùå Leave out props that users might need - Research thoroughly
- ‚ùå Skip edge case handling - Test disabled, error, empty states
- ‚ùå Release untested components - Test everything before considering it done
- ‚ùå Assume "we'll add it later" - Add it now if users will need it

**Remember:** Enhancements are welcome, but bugs and missing features are NOT acceptable. Users consume our design system directly - they shouldn't have to come back asking for features or reporting bugs.

## DO NOT

- ‚ùå Use `string` type for colors - use `IonicColor`
- ‚ùå Manually filter props - use `removeUndefinedProps`
- ‚ùå Duplicate form field code - use form field utilities
- ‚ùå Set `shadow: true` - always use `shadow: false`
- ‚ùå **Leave Ionic sub-components unwrapped** - If users need them, wrap them!
- ‚ùå **Document or show `ion-*` components in examples** - Always use `r-*` components
- ‚ùå **Assume users can use Ionic directly** - They should ONLY use our `r-*` components
- ‚ùå **Create minimal components** - Include ALL useful features and props
- ‚ùå **Skip edge cases** - Handle disabled, error, loading, empty states
- ‚ùå **Release untested** - Test thoroughly before considering done

## Sub-Component Strategy

**When to create sub-component wrappers:**

‚úÖ **DO create wrappers if:**
- The Ionic component has sub-components (e.g., `ion-card` ‚Üí `ion-card-header`, `ion-card-title`)
- Users would need these sub-components to build complete UIs
- The sub-components are part of the component's API (not just internal implementation)

‚ùå **DON'T create wrappers if:**
- The sub-components are purely internal implementation details
- Users never interact with them directly
- They're only used internally by the main component

**Examples:**
- ‚úÖ `ion-card` ‚Üí Need: `r-card`, `r-card-header`, `r-card-title`, `r-card-content`, `r-card-subtitle`, `r-card-footer`
- ‚úÖ `ion-item` ‚Üí Need: `r-item` (if we create it), `r-item-sliding`, `r-item-options`
- ‚ùå `ion-input` ‚Üí No sub-components needed (we already have `r-input`)
- ‚ùå `ion-button` ‚Üí No sub-components needed (we already have `r-button`)

